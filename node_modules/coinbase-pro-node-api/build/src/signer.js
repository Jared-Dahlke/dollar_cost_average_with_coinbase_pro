"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Signer = void 0;
const crypto_1 = require("crypto");
function Signer({
  method,
  url,
  body = "",
  key,
  secret,
  passphrase,
  timestamp,
}) {
  const hmac = crypto_1.createHmac("sha256", Buffer.from(secret, "base64"));
  const message = `${timestamp}${method}${url.pathname}${url.search}${body}`;
  const sign = hmac.update(message).digest("base64");
  return {
    "CB-ACCESS-KEY": key,
    "CB-ACCESS-SIGN": sign,
    "CB-ACCESS-TIMESTAMP": `${timestamp}`,
    "CB-ACCESS-PASSPHRASE": passphrase,
  };
}
exports.Signer = Signer;
